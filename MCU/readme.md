# MCU的AI潜力



## M85内核MCU夺冠 

  

MLCommons在榜单表示，MLPerf Tiny基准测试套件主要针对小于100kB的“微小”神经网络的推理用例，以公平且可重复的方式进行测试，处理来自传感器（包括音频和视觉）的数据，以最小的外形尺寸为低功耗设备提供端点智能。

  

MLperf Tiny v1.2结果包括博世（Bosch）、Kai Jiang（个人）、高通（Qualcomm）、瑞萨（Renesas）、意法半导体（ST）、Skymizer和Syntiant提交的91项整体性能结果，包括18项能量测量。测试基准包括深度自动编码器（Deep Auto-encoder）、DSCNN（依赖敏感卷积神经网络）、MobileNetV1 0.25x、ResNet-V1四项。

  

榜单显示，高通骁龙Gen 3跑分在本次结果中每项基准都是第一，对TinyML来说，智能手机的确是最为典型的例子。其次，则是单板计算机RISC-V核心的Skymizer TinkerV-linux-andes_nn,RISC-V AndesCore AX45MP Single core @1.0GHz，其上核心为Andes的处理器，在深度自动编码器上性能强劲，不过，ResNet-V1处理能力处于中等水平。

  

如果只看MCU的话，瑞萨EK-RA8D1,32 Bit Arm Cortex-M85 @480MHz综合性能第一，在深度自动编码器和ResNet-V1处理能力上都很出色。同时纵观v0.5~v1.2整个榜单，这款MCU的表现都非常亮眼。瑞萨RA8系列作为全球首款Cortex-M85的MCU，依靠M85加入Arm Helium技术，对比过去的DSP+FPU，可见实力强劲。

  

紧接着，ST NUCLEO-H7A3ZI-Q,32-Bit Arm Cortex-M7 @280MHz；ST NUCLEO-L4R5ZI,32-Bit Arm Cortex-M4 @120MHz；ST NUCLEO-U575ZI-Q,Arm Cortex-M33 @160MHz位列二~四。很明显，同属ST的产品跑分，是按照M7、M4、M33排序，这本身也和Arm的分级相符了。

  

博世提交的开发板既包括英飞凌的CY8CPROTO-062-4343W，包括ST的DISCO-F746NG和NUCLEO系列，也包括瑞萨的RH850/F1KM-S4 R7F701649。这些主要就看是什么Arm内核还有DSP、FPU了。

![](../readme.assets/Pasted%20image%2020240422194602.png)
不过，整体来说，由于芯片等级落差颇大，单从推论时间（毫秒ms）及能耗（微焦耳uJ 比较可能会有点不公平，而且MCU、MPU和SoC放在一起“大乱斗”，就更不公平了，都不是一个功耗等级，所以整体还是一个参考，还是要按照实际应用来看。

## **TinyML在十年内攻下MCU**

AI以及大模型的出现，使得千行百业正在发生变化，它不仅要改变服务器端，也会改变边缘端。

数据中心功耗和负载已经发展得很可怕了，加之物联网兴起，不可能每做一次任务，就要问一次服务器怎么做，每个点的设备总归是要有自己的想法。所以TinyML就是把AI应用带到边缘设备（如智能手机、可穿戴、汽车和物联网设备等）上的关键。

AI让边缘更智能，边缘让AI无处不在，对MCU来说，TinyML就是正在发生的变革。

TinyML最大的优点就是可移植性。在具有小电池和低功耗的廉价MCU上运行意味着，使用 TinyML，人们可以很容易地将ML以便宜的价格集成到几乎任何东西中。
![](../readme.assets/Pasted%20image%2020240422194650.png)
从工作机制来看，TinyML 算法的工作机制与传统机器学习模型几乎完全相同，通常在用户计算机或云中完成模型的训练。

不过，TinyML真正发挥之处在于训练后的处理，通常称为“深度压缩”（deep compression）。
![](../readme.assets/Pasted%20image%2020240422194702.png)
TinyML主要拥有两种部署方式：一是直接部署框架，比如说谷歌的TensorFlow LiteMicro、EdgeImpulse等，第二种就是对MCU提供机器学习优化库，提供函数优化运算加速能力，比如说 Arm的CMSIS NN、ST的STM32Cube.AI等。

处理器推进方，有两股势力：一是Arm自己推进自己的Cortex-M系列，如设计出矢量扩展技术Arm Helium，推出为MCU设计的microNPU Ethos U55；二是许多厂商对开源的RISC-V进行CNN推理加速器研究，如蜂鸟E203、GAP-8、Pulpissimo等。

意法半导体微控制器和数字IC事业部总裁Remi El-Ouazzane曾在采访中表示，TinyML将在未来10年成为MCU市场的最大推动力。未来五年内，该公司5亿个MCU将运行某种形式的TinyML 或AI工作负载。

另据统计显示，世界上有超过2500亿个嵌入式设备在运行，预计每年增长20%，而在其中，目前有将近30亿台支持设备会支持TensorsFlow Lite。

厂商近几年结论，便印证上了上述结论，MCU界“六大天王”ST、NXP、Microchip、Renesas、TI、Infineon都在加大布局边缘AI：
- ST在2019年发布STM32Cube.AI工具，并在2021年收购NanoEdge AI Studio，降低边缘AI开发门槛，在今年使用NVIDIA TAO 工具套件拓展STM32边缘AI生态；
    
- NXP在2018年就推出机器学习软件eIQ®机器学习(ML)软件，并不断加大在AI/ML上的投入；
    
- Microchip在2020年就将Cartesiam（现已被ST收购）、Edge Impulse和Motion Gestures的软件和解决方案接口引入其设计环境；
    
- Renesas在2022年完成对美国从事机器学习模型开发的初创企业Reality AI（以TinyML为业务）的收购；
    
- TI最近几年推出的MCU均在边缘AI领域具有优势，包括高集成可扩展的边缘AI处理器组合；
    
- Infineon 2023年5月收购瑞典的TinyML和AutoML领域初创公司Imagimob AB。
    
尽管不断给模型增加参数量，让大模型越来越大是现在AI从业者的坚定方向，不过对机器学习算法而言，设计出内存、计算和能源效率更高的算法发展，也是一个新的趋势。

目前，TinyML仍处于起步阶段，在该方向上的专家也很少。不过，可以预见一拨新趋势，正在款款走来。


曾经，微处理器（MPU）与微控制器（MCU）有着清晰的分界线，二者是功用截然不同的两种器件。现在，随着塞入MCU中的模块越来越丰富，性能越来越强大，这种界限开始渐渐瓦解。

近年来，许多厂商开始推出兼具MCU和MPU性能的MCU产品，MPU和MCU已经开始“有机融合”，既保留传统MCU的实时性和控制力，又在性能上达到了MPU级别，让用户在开发一些特定应用方案时，不需要在实时控制和性能上做妥协。

## MCU和MPU消失的界限 

事实上，关于MCU和MPU的争论已经有很多年了。

传统来说，MPU更多采用Arm Cortex-A系列核心，具备丰富的外设接口，MCU则大多采用Arm Cortex-M系列核心，也比MPU更便宜，更容易安装和使用。

更简单粗暴地划分二者的方式是运行Linux就是MPU，基于实时操作系统（RTOS）就是MCU。MCU的目的是永远运行一个相当简单的控制循环，或者直到它中断或停止。

随着技术和应用的发展，MCU现在可以做很多事情，包括更复杂的外围设备，现在一些MCU带有用于更复杂外设的简单软件驱动程序，此时和MPU界限便开始模糊。

当下，MCU和MPU十分相似，现在主流划分方式主要包括两种：一种是通过细微的参数差别，即CPU功能、位数、操作系统、时序要求、核心数量等方面划分；另一种是按照应用划分，MPU注重通过较为强大的运算/处理能力，执行复杂多样的大型程序，外挂大容量的存储器，MCU则通常运行较为单一的任务，执行对于硬件设备的管理/控制功能，通常以单片集成的方式在单个芯片内部集成小容量的存储器实现系统的“单片化”。

不过，依然有技术人员提出，MCU和MPU已经是过时的术语了，不仅性能上急剧提高，随着3D封装、Chiplet技术的进步，很多过去MPU才有的功能已经放到MCU。

业界则喜欢用“跨界”这样的词语来解释这种趋势和潮流，并不断推出跨界产品。

 越来越像MPU的那些MCU

所谓跨界，就是把MPU才拥有的一些特性或硬件，放到MCU上，如MPU在摄像头输入、显示输出、USB等方面丰富的外设资源塞入MCU之中。

这样，又可以拥有MCU的低功耗、低成本、简单，又能够实现以往MPU才能做的应用。从各个芯片公司的动作来看，跨界MCU是布局的重点。

## **ST：开始越级计划**

从2007年到2018年，ST（意法半导体）花了12年时间，将 “STM32 = 32位MCU = ARM Cortex MCU” 深植于大众之心。2019年，STM32从MCU跨界到MPU，推出第一颗MPU。

蝴蝶扇动翅膀，便可让彼岸刮起暴风雨。STM32这只“蝴蝶”不仅掀起了MCU的风暴，还走进了工程师和千家万户。现在，它也开始把MCU和MPU融合在一起。

2024年3月14日，ST发布一款新的集MPU和MCU两者之长的高性能产品——STM32H7Rx和STM32H7Sx，并计划在2024年4月开始量产。

STM32H7系列本身采用600MHz运行频率的Cortex-M7内核，性能非常强劲。ST将现有产品再细分为两个产品线：STM32H7R3/S3通用MCU和图形处理能力增强的STM32H7R7/S7。

之所以说是跨界，是因为两款MCU集成专用图形处理器和快速存储接口，这种硬件配置多数都放在MPU上。

STM32H7Rx和STM32H7Sx在安全功能上也非常强大，涵盖防止物理攻击、存储器保护、在运行时保护应用程序的代码隔离保护功能。此外，STM32H7S产品还增加了更多的强化的安全功能，集成了不可变的信任根、调试验证，以及硬件加密加速器。

新产品能够实现往往需要用MPU才能跑起来应用，设备厂商可以更快、更经济地开发智能家电、智能楼宇控制器、工业自动化和个人医疗设备，满足终端市场用户日益增长的需求。具体用例包括增加更丰富多彩的图形用户界面，同时执行多个不同的功能。

![](../readme.assets/Pasted%20image%2020241115022115.png)

虽然ST的新品还没有上市，但已被工程师广泛关注。一些工程师将其和国产SoC对比，部分工程师则对其定位存在疑问。

目前来看，这款新品主打低成本和低功耗的图形显示应用，更多信息可能要到产品正式上市才能得知。
![](../readme.assets/Pasted%20image%2020241115022129.png)
## **NXP：填补MCU和MPU空隙**

要说业界谁最先开始布局跨界处理器，那一定是NXP（恩智浦）。自从2017年11月份NXP推出业界第一颗跨界处理器产品i.MX RT1050以来，NXP不断在这条路上扩展新产品。

![](../readme.assets/Pasted%20image%2020241115022139.png)
之所以恩智浦要做i.MX RT系列，是由于很多客户对MCU和运行速度的要求越来越高，从而方便运行语音、图像、Wi-Fi等应用，而以前已有的MCU无法满足这些要求，不得不用到Cortex-A系列核心。
 
Cortex-A核操作系统很复杂，很多工程师无法满足这些要求，加之实时系统放到Cortex-A核上无法保证很好的吻合，因此，i.MX RT系列诞生了。
 
随着产品功能越来越多，对存储单元的要求也越来越高，包括闪存和RAM。对于RAM来说，以前小的MCU都是几kB，甚至Byte级别的RAM，但是现在这些远远不够，因为要运行各种各样的要素。
 
RAM大的好处是运行得快，另一个好处是更安全，因为RAM可以将任务分类，让其变得更安全。i.MX RT产品的RAM特别大，性能特别好。包括未来还会使用的RRAM、MRAM、PCM等新型存储。
 
![](../readme.assets/Pasted%20image%2020241115022201.png)
## **TI：放了个R核**

TI（德州仪器）也曾推出MCU与MPU相结合的Sitara AM2x MCU产品，与上述厂商不同的是，TI的产品更偏向于实时控制，更是在MCU里放入了Cortex-R系列核心。

具体来看，TI将Cortex-R5F、Cortex-M4F、高性能RAM和DDR、信号处理加速器、工业通讯这种高速实时总线的接口联合在一起，再加入实时外设及功能安全和信息安全，设计出AM2x系列的处理器。

通过传统MCU与传统MPU相结合，兼具处理器级计算性能和MCU的设计简易性，集成了实时处理、控制和通信功能，同时易于获取的工具和软件有助于简化开发流程。数据显示，相比于基于闪存的MCU，工程师可以利用的处理能力提高了10倍。

TI之所以推出这样的产品，是因为市场不断增长产生的需求——在性能上新兴应用需要更高等级的系统集成和边缘智能，在控制上工业和汽车系统依赖实时控制和决策，在通信上分布式通信和自动化趋势需要更高的网络带宽。

那么，TI为什么把它称为MCU，而不是MPU？传统的界定方式中，MCU是将CPU、Flash、RAM和各种外设集成在单片芯片上，MCU适合处理某项单一任务；而MPU的CPU，包括CPU的运行和取值，对于内存管理的架构是完全不一样的，从应用上来讲，MPU在很多场合下需要在较复杂的操作系统上运行。

而Sitara AM2x系列产品兼具处理器级的高性能和MCU的设计简易性，是不同功能和外设的合体。AM2x系列主要是应用于需要高速运算，实时控制，实时通讯等场景。

![](../readme.assets/Pasted%20image%2020241115022212.png)
## 瑞萨：超高性能内核
 
2023年10月31日，瑞萨电子（Renasas）发布首款基于Cortex-M85的全新超高性能MCU：RA8M1系列微处理器。 
 
紧接着，又在2023年12月12日推出RA8D1微控制器（MCU）产品群，成为作为瑞萨RA8系列第二款产品。 
 
在跑分上，RA8系列很强，测试分数达到6.39 CoreMark/MHz，缩小了MCU与MPU之间的性能差距。
 
而其最新推出的RA8D1 MCU主要目标是楼宇自动化、家用电器、智能家居、消费及医疗等广泛应用的各类图形显示和语音/视觉多模态AI。 
![](../readme.assets/Pasted%20image%2020241115022232.png)

## **英飞凌：聚焦汽车应用**

2023年12月8日，英飞凌（infineon）推出搭载新型图形引擎的全新TRAVEO T2G-C系列车用MCU。在官网，英飞凌表示该产品“能以MCU的成本为汽车图形应用提供堪比MPU的性能”。

从内核上来看，TRAVEO T2G-C同样是选择Arm Cortex-M7内核，两颗内核频率为320MHz。与此同时，TRAVEO T2G-C系列配有专用的图形加速器，同时采用全新的智能渲染技术，可将图形处理所需的内存减少3至5倍，降低功耗和成本，从而能够以MCU的成本，助力打造具有微处理器性能的仪表盘、车载信息娱乐和座舱系统。

在存储方面，具有6MB的闪存和4MB的内部显存或1GB LPPDR4显存。该系列MCU采用基于英飞凌专利的创新的行缓存处理技术，与市面上同类半导体器件相比，只需要传统帧缓存方案10%的缓存大小，从而降低功耗、内存需求和BOM成本。

## **从MPU反向跨界到MCU**
当然，除了从MCU跨界到MPU，MPU反向跨界MCU也是一个赛道，是打破高端MCU和低端MPU之间的界限的一种产品。

跨界MPU就是将Arm Cortex-A系列核心作为主处理器，另外还会搭载Arm Cortex-M系列核心作为协处理器。这样做的好处是，能够在保持低功耗和实时性能的同时借助开源软件堆栈的能力，并保留传统MPU在摄像头输入、显示输出、USB等方面丰富的外设资源。

最典型的，就是ST和NXP两款产品。

## **ST：复用STM32 MCU的生态和IP**

STM32MP1系列是典型的跨界MPU，也是ST第一颗跨界STM32 MPU。

STM32MP1基于Arm的32位单或双核Cortex-A7和32位Cortex-M4打造，工作频率达到800MHz，为高级HMI开发提供可选的3D图形处理单元（GPU），可以说，它的算力很强。

而STM32MP1灵活的架构可以满足高性能、硬实时、低功耗和安全性的性能；同时，还传承了 STM32的生态系统，不仅有多种硬件开发板、三类软件开发包等，并可将之前基于M4的控制移植到MP1上，从而加快产品开发进度。

简单理解，Arm Cortex-A7运行Linux，Arm Cortex-M4 运行STM32Cube，以此来实现跨界。

从特征参数上看，跨界MPU极具魅力，不过，正如ST官方文档所说的，在使用MPU做产品设计时，要兼顾软件、硬件、PCB等多方资源，还要考虑MCU迁移和市场规律。
![](../readme.assets/Pasted%20image%2020241115022314.png)
## **NXP：同样采用A核和M核双核**

NXP曾经推出的i.MX 7ULP，也是一款跨界MPU。

该产品同样是Cortex-A7和Cortex-M4的双核产品，这样既可以运行在MPU流行的Linux操作系统环境下，待机时又兼具MCU级的低功耗。

i.MX 7ULP很适合既有很强的显示，又不需要长时间的强计算，还要和网络/云端进行通信，低功耗的应用场景。例如智能手表、便携式健康监护设备、便携式设备、家庭控制、智能接入、智能门锁等。

这个产品的前身叫i.MX 7D，同样是双核Cortex-A7与Cortex-M4的双核设计，但功耗还是不够低。根据NXP彼时的介绍，客户要求有尖端的性能，运行速度快，图像质量好，同时还需要待机时间长。因此NXP完全改变了构架，就有了i.MX 7ULP这个概念，兼具运行速度和低功耗，基于两个完全分离的内部构架。
