# 我们一直所追求的CPK>1.67到底代表什么样的制程能力？


不管是在做封装工艺，还是做封装导入工作时，都需要做数据分析，此时标准差、CPK便成为了无法绕开的两个关键指标。以前只管根据既定的公式去计算结果，看其是否在规范内，却很少去想这几个指标代表的真正含义，以及所追求的规范又代表什么样的工艺能力。正好近期群里有人提到这个点。借此机会给大家扒一扒。

我们平时在做数据分析的时候，常用的数据指标有平均值、标准方差、最大值、最小值、cpk等。提到这些指标就绕不开正态分布函数，那么到底什么是正态分布呢？以下是摘自百度百科对其的定义：

正态分布又称高斯分布，其概率密度函数显示为钟形曲线(中间高、两头低，如下图)。现实生活中，许多自然和社会现象均服从正态分布(比如考试成绩和人体身高等)。

![](https://raw.githubusercontent.com/LeroyK111/pictureBed/master/20241231114033.png)
我们针对上图，用更贴近封装的知识去解释其含义。假设我们有100个wire bonding 二焊点拉力的数据样本，其平均值为9g；X轴代表拉力数值，Y轴代表样本中不同拉力数值在100个数据样本中出现的比例，此时会出现，越靠近平均值的数据出现的频率越高，即在均值附近出现峰值；越远离平均值的数据出现的频率越低，因此便形成此钟形曲线，其从-∞到＋∞的积分为1，也就是图中阴影区域面积。  

也许有人会问我为什么会有这种规律，我所能告诉你的就是，这就是自然规律，所谓的科学，就是人类那些伟大的科学家们通过对这些自然规律的不断总结，形成一套逻辑严谨的科学论证去解释这个自然规律，也就是我们现在所学习的各种xx定律等。等到有一天出现了另一个自然现象，用该定律解释不通了，这个定律就会被加上一定的条件限定，比如在相对论和量子力学出现之前，牛顿力学定律便是唯一。

而上文图形右侧的公式，则是对正态分布的数学描述，其因子定义如下：
![](https://raw.githubusercontent.com/LeroyK111/pictureBed/master/20241231114342.png)
均值我们很容易理解，那么什么是方差呢？我们来看看其定义：方差是刻画随机变量在其中心位置附近散布程度的数学特征，反映了随机变量取值的离散程度。其计算公式为：
![](https://raw.githubusercontent.com/LeroyK111/pictureBed/master/20241231114417.png)
方差：样本中所有数据与平均数差值的平方和的均值(如上图左公式)；首先其是去计算所有数值和平均值的差，也就是各数据同平均值之间的距离，然后再对其平方、求和，最后再除以总数据个数求均值，因最终的结果取决于各数据同平均值之间的距离，因此方差反映了数据以中心值为中点的集中程度，方差越大小，数据越集中，方差越大，数据越分散。因方差是一个平方的计算结果，不利于理解，科学界的那些大聪明们对其开方后，出现了标准差。

下图是几个不同标准差下的正态分布图：
![](https://raw.githubusercontent.com/LeroyK111/pictureBed/master/20241231114436.png)
X轴代表我们采集的样本数据值，Y轴代表不同数据在总体样本中出现的概率，为了便于观察，我们让平均值μ=0；从上图可以看出，标准差σ越小，数据向靠近均值的方向集中。定义理解了，它们对于我们工程的意义在哪里呢？

我们还是以熟知的案例进行讲解，假设我们要取样一组关于Wire Bonding焊球偏移的量的数据，焊球边缘到焊盘边缘距离为3um(为了便于大家理解，图形比例画的比较夸张)，焊球左右偏移超出3um则判定为不良。我们定义焊球处在中心位置时为0位，也就是我们抓取数据所要达到的目标值；定义焊球向左偏移为负，向右偏移为正。
![](https://raw.githubusercontent.com/LeroyK111/pictureBed/master/20241231114513.png)
其中LSL为焊球位移向左偏移的极限，即-3um，USL为焊球位移向右偏移的极限，即+3um；其中绿色阴影部分，则为该规范下满足工艺标准±3um焊球出现的比例，即对f(x)在范围LSL至USL之间做积分，其结果为99.73%；这台机器若是开始批量加工，我们预测其良率约为99.73%

上面的案例，是假定我们所取数据的平均值为0的情况下进行的分析，但现实中这种理想状况是不可能存在的，此时我们需要引入另一个参数，叫目标值M，在这个案例当中，目标值即为(USL+LSL)/2=0；当我们所测量的数据均值μ=-0.5，σ=1时，图形则会整体向左偏移0.5um，此时良率预测则下降为99.36%
![](https://raw.githubusercontent.com/LeroyK111/pictureBed/master/20241231114539.png)
聊到这里就完了？大家有没有觉得想要预估过程控制能力的话，要知道USL、LSL，也要知道μ、σ、M，是不是有点过于繁琐？那些聪明的大胡子数学家也考虑到了这个问题，于是他们研究出了cpk。

聊cpk之前，首先说说什么是CP；CP指的是过程能力指数，指过程中平均值μ与目标值M重合的情形；其值等于规格允许的最大范围除以6倍的σ，因此规格范围(USL-LSL)越大，σ越小，cp值就越大，代表生产过程越容易做到规格范围内(如下图所示)。
![](https://raw.githubusercontent.com/LeroyK111/pictureBed/master/20241231114614.png)

那么这里的6σ和我们常说的六西格玛有是否有关系呢？此时就要引入西格玛水平这个概念。西格玛水平：在质量管理领域，西格玛水平（Sigma Level）是衡量过程能力或产品质量水平的一个指标，它表示过程满足质量要求的能力。

当规格允许的最大范围宽度等于6σ时，其一半宽度即为3σ，也就是我们常说的三西格玛水平；当规格允许最大范围宽度为6σ的1.33倍时，其一半宽度约为4σ，即为四西格玛水平；当规格允许的最大宽度为6σ的1.67倍时，其一半宽度为5σ，即为五西格玛水平；当规格允许的最大宽度为6σ的2倍时，其一半宽度为6σ，即为六西格玛水平；

而CPK，则适用于过程输出平均值与目标值不重合的情形，即μ≠M，此时我们需要引入一个k值，其定义为μ与M的差值除以规格范围的一半，代表其向规格中心某一侧偏移的比例。因此其越小，结果越理想。cpk则综合了k值和Cp，k值越小越理想，Cp越大越理想，因此CPK值越大越理想。
![](https://raw.githubusercontent.com/LeroyK111/pictureBed/master/20241231114648.png)
![](https://raw.githubusercontent.com/LeroyK111/pictureBed/master/20241231114726.png)
此时我们假设μ=1.5σ，再尝试利用积分求解计算器计算不同cpk下的不良比例，如下图所示：
![](https://raw.githubusercontent.com/LeroyK111/pictureBed/master/20241231114800.png)
当μ≠M，正态分布曲线发生偏移，μ值从原本的0(左图)，变为一个1.5σ(右图)，因此导致k值变大，根据cpk计算公式cpk=(1-k)*cp，如要保证cpk值不变，则需让cp值变大；根据cp计算公式：cp=(USL-LSL)/(6σ)，假设数据标准差σ不变为1，那么USL-LSL则需增大。经计算，当USL-LSL从之前的6倍σ增加到右图的9倍σ之后，cpk可保持为1，此时相当于右图的曲线中心线向右侧的积分结果同左图一致，右图中心线向左侧积分结果相当于比左图多积分了1.5倍σ，因此不良比例的PPM值约为之前的一半。反之，若要保持cpk不变，又不想动USL和LSL，那么所取的数据样本标准差值就得等比例减小。


















