在IC设计公司，封装工程师必须要做的一项工作则是绘制各种封装加工图纸。对于传统封装而言，最常见的三个图纸则是封装打线图、POD图纸、印字方案。其中最麻烦，最容易出错的则是打线图。  

因为IC设计工程师提供给封装工程师的，是芯片每个焊盘的坐标数据以及尺寸数据，封装工程师需将这些数据信息转换为CAD图形以便工厂加工。转换过程中，最呆瓜的做法就是将这些数据一个一个在CAD中Key出来(小弟不才，将这种呆瓜方法用了有一年多)，而手动key数据耗时费力，效率极低，且极易出错，出错后又不自知，后患无穷。

![](../readme.assets/Pasted%20image%2020250101122847.png)

为此小弟潜心研究，终于找到一个稍显智慧的办法，共分为两步。

**第一步：画pad方框**

将Pad Location里面每个pad中心点坐标以及BPO尺寸信息在Excel中转换为pad的两个角点坐标。

第一角点选择左上角，第一角点X=中心点X-BPO_X/2，第一角点Y=中心点Y+BPO_Y/2

第二角点选择右下角，第二角点X=中心点X+BPO_X/2，第二角点Y=中心点Y-BPO_Y/2
![](../readme.assets/Pasted%20image%2020250101122855.png)
数据转换完成后，对其进行格式转换，将Excel格式转换为TEXT格式，此处需注意几个问题：  

1. TEXT文件中，RECTANG和第一角点X间被一个空格隔开；  
    
2. 第一、第二角点的X、Y被逗号隔开(英文格式的逗号)；
    
3. 第一角点的Y与第二角点的X之间被一个空格隔开；
    
4. 最后一行数据的末尾，需多加一个空格，否则最后一个pad画不出来。


![](../readme.assets/Pasted%20image%2020250101122904.png)

处理好这些数据后，将TEXT文件中的数据内容全部复制，然后打开CAD软件，在其命令栏输入"RECTANG"后敲回车键，再将复制好的内容"Ctrl+V"粘贴进去即可，软件则会自动绘制各pad方框，绘制好的图像如下图：

![](../readme.assets/Pasted%20image%2020250101122914.png)

**第二步：为各pad编号**  

这一步主要是针对pad比较多的芯片，避免做打线图互联时出错，为各pad编号便于对应。  

将pad编号信息与pad location信息在Excel表中按照以下格式一一对应，其中"TEXT"为编号的命令信息，"J"、"M"为将字符居中的命令，中心点则对应Pad Location的中心点坐标即可，这样字符中心即与Pad中心位置重合，字体高度可根据实际Pad尺寸设置，角度为0，字符则为最终显示结果。
![](../readme.assets/Pasted%20image%2020250101122923.png)

与第一步一样，将Excel中的数据粘贴至TEXT文件中，其中除了中心点X、Y之间使用英文的逗号分隔外，其余均使用空格做分隔符。
![](../readme.assets/Pasted%20image%2020250101122932.png)
最后将TEXT文件的后缀名改为".scr"格式，这样就可以用CAD脚本直接调用了。

在CAD中点击"管理"-->"运行脚本"然后选中".scr"文件

![](../readme.assets/Pasted%20image%2020250101122940.png)
绘制好带编号的局部图形如下

![](../readme.assets/Pasted%20image%2020250101122953.png)




